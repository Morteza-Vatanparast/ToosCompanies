{% extends base.html %}
{% block other_css %}
<link rel="stylesheet" type="text/css" href="{{ static_url('plugins/bootstrap-fileupload/bootstrap-fileupload.css') }}">
<link rel="stylesheet" type="text/css" href="{{ static_url('plugins/cropper/cropper.min.css') }}">
<link rel="stylesheet" type="text/css" href="{{ static_url('css/cropit.css') }}">
{% end block other_css %}
{% block container %}
    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-default margin-top-30 font-yekan">
                    <div class="panel-heading"><i class="fa fa-folder-open-o"></i><span>ویرایش و مدیریت واحد های شرکت ها</span> </div>
                    <div class="panel-body">
                        <div class="show_box">
                            <div class="box_header">
                                <span>ویرایش شرکت</span>
                            </div>
                            <div class="box_body unit-div pr_drag">
                                <form id="add_company">
                                    {% module xsrf_form_html() %}
                                    <div class="row">
                                        <div class="col-xs-9">
                                            <div class="row">
                                                <div class="col-xs-3 text-right">
                                                    <span>نام:</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input name="name" value="{{ company['name'] }}" type="text" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3 text-right">
                                                </div>
                                                <div class="col-xs-9">
                                                    <div class="row">
                                                        <div class="col-md-4 text-center"><span style="margin-left: 10px">صفحه اصلی</span><input {% if company['main_page'] %}checked{% end %} type="checkbox" name="main_page" value="True"></div>
                                                        <div class="col-md-4 text-center"><span style="margin-left: 10px">اسلایدر</span><input class="has-slider" {% if company['slider'] %}checked{% end %} type="checkbox" name="slider" value="True"></div>
                                                        <div class="col-md-4 text-center"><span style="margin-left: 10px">فعال </span><input {% if company['active'] %}checked{% end %} type="checkbox" name="active" value="True"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <input type="hidden" name="logo">
                                                <div class="col-xs-3">
                                                    <span class="form_label">لوگو</span>
                                                </div>
                                                <div class="col-xs-3">
                                                    <div class="row" style="margin: 10px 0">
                                                        <div class="col-md-12 col-sm-12 text-center" style="direction: ltr">
                                                            <div id="company_logo_show" class="thumbnail preview-lg" style="overflow: hidden;width: 184px; height: 142px; margin: auto">
                                                                <img class="recipe_photo" src="{% if company['logo'] is not None %}{{ static_url('images/company_logo/' + company['logo']) }}{% end %}" alt="" />
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12 col-sm-12 text-center margin-top-20">
                                                            <span data-toggle="modal" href="#company_logo_modal" class="R_butt_blue">انتخاب تصویر</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-2" style="margin-right: 40px">
                                                    <span class="form_label">عکس</span>
                                                    <input type="hidden" name="image">
                                                </div>
                                                <div class="col-xs-3">
                                                    <div class="row" style="margin: 10px 0">
                                                        <div class="col-md-12 col-sm-12 text-center" style="direction: ltr">
                                                            <div id="company_image_show" class="thumbnail preview-lg" style="overflow: hidden;width: 184px; height: 142px; margin: auto">
                                                                <img class="recipe_photo" src="{% if company['image'] is not None %}{{ static_url('images/company_image/' + company['image']) }}{% end %}" alt="" />
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12 col-sm-12 text-center margin-top-20">
                                                            <span data-toggle="modal" href="#company_image_modal" class="R_butt_blue">انتخاب تصویر</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10 slider-div" {% if not company['slider'] %}style="display: none"{% end %}>
                                                <div class="col-xs-3">
                                                    <span class="form_label">اسلایدر</span>
                                                    <input type="hidden" name="slider_image">
                                                </div>
                                                <div class="col-xs-9">
                                                    <div class="row" style="margin: 10px 0">
                                                        <div class="col-md-12 col-sm-12 text-center" style="direction: ltr">
                                                            <div id="company_slider_show" class="thumbnail preview-lg" style="overflow: hidden;width: 184px; height: 142px; margin: auto">
                                                                <img class="recipe_photo" src="{% if company['slider'] %}{{ static_url('images/company_slider/' + str(company['slider_image'])) }}{% else %}http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image{% end %}" alt="" />
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12 col-sm-12 text-center margin-top-20">
                                                            <span data-toggle="modal" href="#company_slider_modal" class="R_butt_blue">انتخاب تصویر</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">آدرس</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <textarea class="form-control" cols="10" rows="5" name="address" style="resize: none">{{ company['address'] }}</textarea>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">موبایل</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" name="mobile" value="{{ company['mobile'] }}" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">تلفن</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" name="phone" value="{{ company['phone'] }}" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">تلفن 2</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" name="phone2" value="{{ company['phone2'] }}" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">فکس</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" name="fax" value="{{ company['fax'] }}" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">سایت</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" name="site" value="{{ company['site'] }}" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">ایمیل</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" name="email" value="{{ company['email'] }}" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">مدیر عامل</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" name="ceo" value="{{ company['ceo'] }}" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">مالک</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" value="{{ company['owner'] }}" name="owner" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">مسئول هماهنگی</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input type="text" value="{{ company['coordinator'] }}" name="coordinator" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">استان</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <select class="select" name="province">
                                                        <option value="">انتخاب کنید.</option>
                                                        {% for p in provinces %}
                                                            <option {% if company['province'] == p['_id'] %}selected{% end %} value="{{ p['_id'] }}">{{ p['name'] }}</option>
                                                        {% end %}
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">شهر</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <select class="select" name="city">
                                                        <option value="">انتخاب کنید.</option>
                                                        {% for c in cities %}
                                                            <option {% if company['city'] == c['_id'] %}selected{% end %} value="{{ c['_id'] }}">{{ c['name'] }}</option>
                                                        {% end %}
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">واحد</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <select class="select" name="unit">
                                                        <option value="">انتخاب کنید.</option>
                                                        {% for u in units %}
                                                            <option {% if company['unit'] == u['_id'] %}selected{% end %} value="{{ u['_id'] }}">{{ u['name'] }}</option>
                                                        {% end %}
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">شهرک صنعتی</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <select class="select" name="industrial_town">
                                                        <option value="">انتخاب کنید.</option>
                                                        {% for i in industrial_towns %}
                                                            <option {% if company['industrial_town'] == i['_id'] %}selected{% end %} value="{{ i['_id'] }}">{{ i['name'] }}</option>
                                                        {% end %}
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="add-image-div" {% if len(company['images']) >= 4 %}style="display: none" {% end %}>
                                                    <div class="col-xs-3">
                                                        <span class="form_label">عکس ها</span>
                                                    </div>
                                                    <div class="col-xs-3 col-md-offset-3">
                                                        <div class="R_butt_blue add-image text-center">+ افزودن عکس</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10 images-uploads">
                                                <div class="col-xs-3 images-div" {% if len(company['images']) < 1 %}style="display: none"{% end %} data-image="1">
                                                    <input type="hidden" class="input-images" name="images_1">
                                                    <div class="delete-image {% if len(company['images']) >= 1 %}base-image{% end %}" data-image="{% try %}{{ company['images'][0] }}{% except %}{% end %}"><i class="fa fa-times cursor-pointer" style="z-index: 999;font-size: 30px; color: red; float: right;"></i></div>
                                                    <div class="row" style="margin: 10px 0">
                                                        <div class="col-md-12 col-sm-12 text-center" style="direction: ltr">
                                                            <div class="thumbnail preview-lg" id="company_images_1_show" style="overflow: hidden;width: 100%; margin: auto">
                                                                <img class="recipe_photo" src="{% try %}{{ static_url('images/company_images/' + company['images'][0]) }}{% except %}http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image{% end %}" alt="" />
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12 col-sm-12 text-center margin-top-20">
                                                            <span data-toggle="modal" href="#company_images_1_modal" class="R_butt_blue">انتخاب تصویر</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-3 images-div" {% if len(company['images']) < 2 %}style="display: none"{% end %} data-image="2">
                                                    <input type="hidden" class="input-images" name="images_2">
                                                    <div class="delete-image {% if len(company['images']) >= 2 %}base-image{% end %}" data-image="{% try %}{{ company['images'][1] }}{% except %}{% end %}"><i class="fa fa-times cursor-pointer" style="z-index: 999;font-size: 30px; color: red; float: right;"></i></div>
                                                    <div class="row" style="margin: 10px 0">
                                                        <div class="col-md-12 col-sm-12 text-center" style="direction: ltr">
                                                            <div class="thumbnail preview-lg" id="company_images_2_show" style="overflow: hidden;width: 100%; margin: auto">
                                                                <img class="recipe_photo" src="{% try %}{{ static_url('images/company_images/' + company['images'][1]) }}{% except %}http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image{% end %}" alt="" />
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12 col-sm-12 text-center margin-top-20">
                                                            <span data-toggle="modal" href="#company_images_2_modal" class="R_butt_blue">انتخاب تصویر</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-3 images-div" {% if len(company['images']) < 3 %}style="display: none"{% end %} data-image="3">
                                                    <input type="hidden" class="input-images" name="images_3">
                                                    <div class="delete-image {% if len(company['images']) >= 3 %}base-image{% end %}" data-image="{% try %}{{ company['images'][2] }}{% except %}{% end %}"><i class="fa fa-times cursor-pointer" style="z-index: 999;font-size: 30px; color: red; float: right;"></i></div>
                                                    <div class="row" style="margin: 10px 0">
                                                        <div class="col-md-12 col-sm-12 text-center" style="direction: ltr">
                                                            <div class="thumbnail preview-lg" id="company_images_3_show" style="overflow: hidden;width: 100%; margin: auto">
                                                                <img class="recipe_photo" src="{% try %}{{ static_url('images/company_images/' + company['images'][2]) }}{% except %}http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image{% end %}" alt="" />
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12 col-sm-12 text-center margin-top-20">
                                                            <span data-toggle="modal" href="#company_images_3_modal" class="R_butt_blue">انتخاب تصویر</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-3 images-div" {% if len(company['images']) < 4 %}style="display: none"{% end %} data-image="4">
                                                    <input type="hidden" class="input-images" name="images_4">
                                                    <div class="delete-image {% if len(company['images']) >= 4 %}base-image{% end %}" data-image="{% try %}{{ company['images'][3] }}{% except %}{% end %}"><i class="fa fa-times cursor-pointer" style="z-index: 999;font-size: 30px; color: red; float: right;"></i></div>
                                                    <div class="row" style="margin: 10px 0">
                                                        <div class="col-md-12 col-sm-12 text-center" style="direction: ltr">
                                                            <div class="thumbnail preview-lg" id="company_images_4_show" style="overflow: hidden;width: 100%; margin: auto">
                                                                <img class="recipe_photo" src="{% try %}{{ static_url('images/company_images/' + company['images'][3]) }}{% except %}http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image{% end %}" alt="" />
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12 col-sm-12 text-center margin-top-20">
                                                            <span data-toggle="modal" href="#company_images_4_modal" class="R_butt_blue">انتخاب تصویر</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">توضیحات</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <input class="form-control" name="description" value="{{ company['description'] }}" style="resize: none">
                                                </div>
                                            </div>
                                            <div class="row margin-top-10">
                                                <div class="col-xs-3">
                                                    <span class="form_label">درباره شرکت</span>
                                                </div>
                                                <div class="col-xs-9">
                                                    <textarea class="form-control" cols="10" rows="10" name="about" style="resize: none">{{ company['about'] }}</textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row margin-top-10">
                                        <div class="col-xs-2 pull-left">
                                            <button type="submit" class="btn R_butt_green add-unit-btn">اعمال تغییرات</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


<div class="modal fade in" id="company_logo_modal" tabindex="-1" role="basic" aria-hidden="false">
    <div class="modal-dialog" style="font-family: Yekan; width: 50%">
        <div class="modal-content" style="border-radius: 7px !important;">
            <div class="col-md-12 col-sm-12">
                <div class="row" style="background: #b8b8b8;border-radius: 5px 5px 0px 0px !important;padding:10px;">
                    <div class="pull-left">
                        <span style="color: white;font-size: 12pt;margin-top: 2px;display: block">انتخاب تصویر</span>
                    </div>
                    <div class="pull-right">
                        <span class="cursor fa fa-times"
                              style="font-size:15pt;color: white !important;margin-top: 5px;cursor: pointer"
                              data-dismiss="modal" aria-hidden="true"></span>
                    </div>
                </div>
                <div class="row" style="background: #ffffff">
                    <div class="col-md-12 col-sm-12">
                        <div id="company_logo" style="direction: ltr">
                            <div class="row margin-top-25">
                                <div class="col-md-8 col-md-offset-2">
                                    <div class="cropit-image-preview-container">
                                        <div class="cropit-image-preview"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15">
                                <div class="col-md-6 col-md-offset-3">
                                    <div class="row">
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 24px"></i>
                                        </div>
                                        <div class="col-md-8 col-sm-8">
                                            <input type="range" class="cropit-image-zoom-input" />
                                        </div>
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 16px"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15 margin-bottom-15">
                                <div class="col-md-4 col-md-offset-4 choose_pic_div">
                                    <input type="file" style="display: none" class="cropit-image-input" />
                                    <div class="R_butt_blue choose_pic text-center">انتخاب تصویر</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="border-top: 1px solid #ccc; padding: 15px;background: #b8b8b8">
                    <div class="col-md-6 col-sm-6 text-right pull-right">
                        <span data-dismiss="modal" class="R_butt_green send_image_logo">تایید تصویر</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade in" id="company_slider_modal" tabindex="-1" role="basic" aria-hidden="false">
    <div class="modal-dialog" style="font-family: Yekan; width: 55%">
        <div class="modal-content" style="border-radius: 7px !important;">
            <div class="col-md-12 col-sm-12">
                <div class="row" style="background: #b8b8b8;border-radius: 5px 5px 0px 0px !important;padding:10px;">
                    <div class="pull-left">
                        <span style="color: white;font-size: 12pt;margin-top: 2px;display: block">انتخاب تصویر</span>
                    </div>
                    <div class="pull-right">
                        <span class="cursor fa fa-times"
                              style="font-size:15pt;color: white !important;margin-top: 5px;cursor: pointer"
                              data-dismiss="modal" aria-hidden="true"></span>
                    </div>
                </div>
                <div class="row" style="background: #ffffff">
                    <div class="col-md-12 col-sm-12">
                        <div id="company_slider" style="direction: ltr">
                            <div class="row margin-top-25">
                                <div class="col-md-12">
                                    <div class="cropit-image-preview-container">
                                        <div class="cropit-image-preview"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15">
                                <div class="col-md-6 col-md-offset-3">
                                    <div class="row">
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 24px"></i>
                                        </div>
                                        <div class="col-md-8 col-sm-8">
                                            <input type="range" class="cropit-image-zoom-input" />
                                        </div>
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 16px"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15 margin-bottom-15">
                                <div class="col-md-4 col-md-offset-4 choose_pic_div">
                                    <input type="file" style="display: none" class="cropit-image-input" />
                                    <div class="R_butt_blue choose_pic text-center">انتخاب تصویر</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="border-top: 1px solid #ccc; padding: 15px;background: #b8b8b8">
                    <div class="col-md-6 col-sm-6 text-right pull-right">
                        <span data-dismiss="modal" class="R_butt_green send_image_slider">تایید تصویر</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade in" id="company_image_modal" tabindex="-1" role="basic" aria-hidden="false">
    <div class="modal-dialog" style="font-family: Yekan; width: 50%">
        <div class="modal-content" style="border-radius: 7px !important;">
            <div class="col-md-12 col-sm-12">
                <div class="row" style="background: #b8b8b8;border-radius: 5px 5px 0px 0px !important;padding:10px;">
                    <div class="pull-left">
                        <span style="color: white;font-size: 12pt;margin-top: 2px;display: block">انتخاب تصویر</span>
                    </div>
                    <div class="pull-right">
                        <span class="cursor fa fa-times"
                              style="font-size:15pt;color: white !important;margin-top: 5px;cursor: pointer"
                              data-dismiss="modal" aria-hidden="true"></span>
                    </div>
                </div>
                <div class="row" style="background: #ffffff">
                    <div class="col-md-12 col-sm-12">
                        <div id="company_image" style="direction: ltr">
                            <div class="row margin-top-25">
                                <div class="col-md-8 col-md-offset-2">
                                    <div class="cropit-image-preview-container">
                                        <div class="cropit-image-preview"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15">
                                <div class="col-md-6 col-md-offset-3">
                                    <div class="row">
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 24px"></i>
                                        </div>
                                        <div class="col-md-8 col-sm-8">
                                            <input type="range" class="cropit-image-zoom-input" />
                                        </div>
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 16px"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15 margin-bottom-15">
                                <div class="col-md-4 col-md-offset-4 choose_pic_div">
                                    <input type="file" style="display: none" class="cropit-image-input" />
                                    <div class="R_butt_blue choose_pic text-center">انتخاب تصویر</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="border-top: 1px solid #ccc; padding: 15px;background: #b8b8b8">
                    <div class="col-md-6 col-sm-6 text-right pull-right">
                        <span data-dismiss="modal" class="R_butt_green send_image_image">تایید تصویر</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade in" id="company_images_1_modal" tabindex="-1" role="basic" aria-hidden="false">
    <div class="modal-dialog" style="font-family: Yekan; width: 50%">
        <div class="modal-content" style="border-radius: 7px !important;">
            <div class="col-md-12 col-sm-12">
                <div class="row" style="background: #b8b8b8;border-radius: 5px 5px 0px 0px !important;padding:10px;">
                    <div class="pull-left">
                        <span style="color: white;font-size: 12pt;margin-top: 2px;display: block">انتخاب تصویر</span>
                    </div>
                    <div class="pull-right">
                        <span class="cursor fa fa-times"
                              style="font-size:15pt;color: white !important;margin-top: 5px;cursor: pointer"
                              data-dismiss="modal" aria-hidden="true"></span>
                    </div>
                </div>
                <div class="row" style="background: #ffffff">
                    <div class="col-md-12 col-sm-12">
                        <div id="company_images_1" style="direction: ltr">
                            <div class="row margin-top-25">
                                <div class="col-md-8 col-md-offset-2">
                                    <div class="cropit-image-preview-container">
                                        <div class="cropit-image-preview"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15">
                                <div class="col-md-6 col-md-offset-3">
                                    <div class="row">
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 24px"></i>
                                        </div>
                                        <div class="col-md-8 col-sm-8">
                                            <input type="range" class="cropit-image-zoom-input" />
                                        </div>
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 16px"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15 margin-bottom-15">
                                <div class="col-md-4 col-md-offset-4 choose_pic_div">
                                    <input type="file" style="display: none" class="cropit-image-input" />
                                    <div class="R_butt_blue choose_pic text-center">انتخاب تصویر</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="border-top: 1px solid #ccc; padding: 15px;background: #b8b8b8">
                    <div class="col-md-6 col-sm-6 text-right pull-right">
                        <span data-dismiss="modal" class="R_butt_green send_image_images_1">تایید تصویر</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade in" id="company_images_2_modal" tabindex="-1" role="basic" aria-hidden="false">
    <div class="modal-dialog" style="font-family: Yekan; width: 50%">
        <div class="modal-content" style="border-radius: 7px !important;">
            <div class="col-md-12 col-sm-12">
                <div class="row" style="background: #b8b8b8;border-radius: 5px 5px 0px 0px !important;padding:10px;">
                    <div class="pull-left">
                        <span style="color: white;font-size: 12pt;margin-top: 2px;display: block">انتخاب تصویر</span>
                    </div>
                    <div class="pull-right">
                        <span class="cursor fa fa-times"
                              style="font-size:15pt;color: white !important;margin-top: 5px;cursor: pointer"
                              data-dismiss="modal" aria-hidden="true"></span>
                    </div>
                </div>
                <div class="row" style="background: #ffffff">
                    <div class="col-md-12 col-sm-12">
                        <div id="company_images_2" style="direction: ltr">
                            <div class="row margin-top-25">
                                <div class="col-md-8 col-md-offset-2">
                                    <div class="cropit-image-preview-container">
                                        <div class="cropit-image-preview"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15">
                                <div class="col-md-6 col-md-offset-3">
                                    <div class="row">
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 24px"></i>
                                        </div>
                                        <div class="col-md-8 col-sm-8">
                                            <input type="range" class="cropit-image-zoom-input" />
                                        </div>
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 16px"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15 margin-bottom-15">
                                <div class="col-md-4 col-md-offset-4 choose_pic_div">
                                    <input type="file" style="display: none" class="cropit-image-input" />
                                    <div class="R_butt_blue choose_pic text-center">انتخاب تصویر</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="border-top: 1px solid #ccc; padding: 15px;background: #b8b8b8">
                    <div class="col-md-6 col-sm-6 text-right pull-right">
                        <span data-dismiss="modal" class="R_butt_green send_image_images_2">تایید تصویر</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade in" id="company_images_3_modal" tabindex="-1" role="basic" aria-hidden="false">
    <div class="modal-dialog" style="font-family: Yekan; width: 50%">
        <div class="modal-content" style="border-radius: 7px !important;">
            <div class="col-md-12 col-sm-12">
                <div class="row" style="background: #b8b8b8;border-radius: 5px 5px 0px 0px !important;padding:10px;">
                    <div class="pull-left">
                        <span style="color: white;font-size: 12pt;margin-top: 2px;display: block">انتخاب تصویر</span>
                    </div>
                    <div class="pull-right">
                        <span class="cursor fa fa-times"
                              style="font-size:15pt;color: white !important;margin-top: 5px;cursor: pointer"
                              data-dismiss="modal" aria-hidden="true"></span>
                    </div>
                </div>
                <div class="row" style="background: #ffffff">
                    <div class="col-md-12 col-sm-12">
                        <div id="company_images_3" style="direction: ltr">
                            <div class="row margin-top-25">
                                <div class="col-md-8 col-md-offset-2">
                                    <div class="cropit-image-preview-container">
                                        <div class="cropit-image-preview"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15">
                                <div class="col-md-6 col-md-offset-3">
                                    <div class="row">
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 24px"></i>
                                        </div>
                                        <div class="col-md-8 col-sm-8">
                                            <input type="range" class="cropit-image-zoom-input" />
                                        </div>
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 16px"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15 margin-bottom-15">
                                <div class="col-md-4 col-md-offset-4 choose_pic_div">
                                    <input type="file" style="display: none" class="cropit-image-input" />
                                    <div class="R_butt_blue choose_pic text-center">انتخاب تصویر</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="border-top: 1px solid #ccc; padding: 15px;background: #b8b8b8">
                    <div class="col-md-6 col-sm-6 text-right pull-right">
                        <span data-dismiss="modal" class="R_butt_green send_image_images_3">تایید تصویر</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade in" id="company_images_4_modal" tabindex="-1" role="basic" aria-hidden="false">
    <div class="modal-dialog" style="font-family: Yekan; width: 50%">
        <div class="modal-content" style="border-radius: 7px !important;">
            <div class="col-md-12 col-sm-12">
                <div class="row" style="background: #b8b8b8;border-radius: 5px 5px 0px 0px !important;padding:10px;">
                    <div class="pull-left">
                        <span style="color: white;font-size: 12pt;margin-top: 2px;display: block">انتخاب تصویر</span>
                    </div>
                    <div class="pull-right">
                        <span class="cursor fa fa-times"
                              style="font-size:15pt;color: white !important;margin-top: 5px;cursor: pointer"
                              data-dismiss="modal" aria-hidden="true"></span>
                    </div>
                </div>
                <div class="row" style="background: #ffffff">
                    <div class="col-md-12 col-sm-12">
                        <div id="company_images_4" style="direction: ltr">
                            <div class="row margin-top-25">
                                <div class="col-md-8 col-md-offset-2">
                                    <div class="cropit-image-preview-container">
                                        <div class="cropit-image-preview"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15">
                                <div class="col-md-6 col-md-offset-3">
                                    <div class="row">
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 24px"></i>
                                        </div>
                                        <div class="col-md-8 col-sm-8">
                                            <input type="range" class="cropit-image-zoom-input" />
                                        </div>
                                        <div class="col-md-2 col-sm-2">
                                            <i class="fa fa-picture-o" style="font-size: 16px"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row margin-top-15 margin-bottom-15">
                                <div class="col-md-4 col-md-offset-4 choose_pic_div">
                                    <input type="file" style="display: none" class="cropit-image-input" />
                                    <div class="R_butt_blue choose_pic text-center">انتخاب تصویر</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" style="border-top: 1px solid #ccc; padding: 15px;background: #b8b8b8">
                    <div class="col-md-6 col-sm-6 text-right pull-right">
                        <span data-dismiss="modal" class="R_butt_green send_image_images_4">تایید تصویر</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% end block container %}

{% block other_scripts %}
<script type="text/javascript" src="{{ static_url('plugins/bootstrap-fileupload/bootstrap-fileupload.js') }}"></script>
<script type="text/javascript" src="{{ static_url('plugins/jquery-ui/jquery-ui.js') }}"></script>
<script type="text/javascript" src="{{ static_url('plugins/cropper/jquery.cropit.min.js') }}"></script>
<script>

    var trash = '<i class="fa fa-trash-o"></i>';

    var loader = '<img src="{{ static_url('images/loading.gif') }}" width="20" height="20">';

    var __error = false;
    var __message = false;
    function check_value(__val, __msg){
        if((__val == "" || __val == " ") && !__error){
            __error = true;
            __message = __msg;
        }
        return __val
    }

    $('.choose_pic').click(function(){
         $(this).closest('.choose_pic_div').find('.cropit-image-input').click();
    });

    var company_logo = $('#company_logo').cropit({
        exportZoom: 1,
        height: 120,
        width: 120,
        imageBackground: true,
        imageBackgroundBorderWidth: 15 // Width of background border
    });

    $('.send_image_logo').click(function(){
        var h = company_logo.cropit('export');
        $('#company_logo_show img').attr({ src: h });
        $('input[name=logo]').val(h);
    });

    var company_slider = $('#company_slider').cropit({
        exportZoom: 1,
        height: 340,
        width: 642,
        imageBackground: true,
        imageBackgroundBorderWidth: 15 // Width of background border
    });

    $('.send_image_slider').click(function(){
        var h = company_slider.cropit('export');
        $('#company_slider_show img').attr({ src: h });
        $('input[name=slider_image]').val(h);
    });

    var company_image = $('#company_image').cropit({
        exportZoom: 1,
        height: 240,
        width: 318,
        imageBackground: true,
        imageBackgroundBorderWidth: 15 // Width of background border
    });

    $('.send_image_image').click(function(){
        var h = company_image.cropit('export');
        $('#company_image_show img').attr({ src: h });
        $('input[name=image]').val(h);
    });

    var company_images_1 = $('#company_images_1').cropit({
        exportZoom: 1,
        height: 305,
        width: 320,
        imageBackground: true,
        imageBackgroundBorderWidth: 15 // Width of background border
    });

    $('.send_image_images_1').click(function(){
        var h = company_images_1.cropit('export');
        $('#company_images_1_show img').attr({ src: h });
        $('input[name=images_1]').val(h);
    });

    var company_images_2 = $('#company_images_2').cropit({
        exportZoom: 1,
        height: 305,
        width: 320,
        imageBackground: true,
        imageBackgroundBorderWidth: 15 // Width of background border
    });

    $('.send_image_images_2').click(function(){
        var h = company_images_2.cropit('export');
        $('#company_images_2_show img').attr({ src: h });
        $('input[name=images_2]').val(h);
    });

    var company_images_3 = $('#company_images_3').cropit({
        exportZoom: 1,
        height: 305,
        width: 320,
        imageBackground: true,
        imageBackgroundBorderWidth: 15 // Width of background border
    });

    $('.send_image_images_3').click(function(){
        var h = company_images_3.cropit('export');
        $('#company_images_3_show img').attr({ src: h });
        $('input[name=images_3]').val(h);
    });

    var company_images_4 = $('#company_images_4').cropit({
        exportZoom: 1,
        height: 305,
        width: 320,
        imageBackground: true,
        imageBackgroundBorderWidth: 15 // Width of background border
    });

    $('.send_image_images_4').click(function(){
        var h = company_images_4.cropit('export');
        $('#company_images_4_show img').attr({ src: h });
        $('input[name=images_4]').val(h);
    });

    var __a = true;
    $('#add_company').submit(function(e){
        if(__a){
            var btn =$('.add-unit-btn') ;
            btn.html(loader);
            __a = false;
            e.preventDefault();
            var data = new FormData();
            data.append('_xsrf', '{{ handler.xsrf_token }}');
            data.append('name', check_value($('input[name=name]').val(), 'نام را وارد کنید.'));
            data.append('address', $('textarea[name=address]').val());
            data.append('phone', $('input[name=phone]').val());
            data.append('mobile', $('input[name=mobile]').val());
            data.append('phone2', $('input[name=phone2]').val());
            data.append('fax', $('input[name=fax]').val());
            data.append('site', $('input[name=site]').val());
            data.append('email', $('input[name=email]').val());
            data.append('ceo', $('input[name=ceo]').val());
            data.append('owner', $('input[name=owner]').val());
            data.append('province', check_value($('select[name=province]').val(), 'استان را وارد کنید.'));
            data.append('city', check_value($('select[name=city]').val(), 'شهر را وارد کنید.'));
            data.append('main_page', $('input[name=main_page]').prop("checked"));
            data.append('slider', $('input[name=slider]').prop("checked"));
            data.append('active', $('input[name=active]').prop("checked"));
            data.append('description', $('input[name=description]').val());
            data.append('about', $('textarea[name=about]').val());
            data.append('unit', check_value($('select[name=unit]').val(), 'واحد را وارد کنید.'));
            data.append('industrial_town', check_value($('select[name=industrial_town]').val(), 'شهرک صنعتی  را وارد کنید.'));
            data.append('logo', $('input[name=logo]').val());
            data.append('image', $('input[name=image]').val());
            if($('input[type=checkbox][name=slider]').prop("checked")){
                data.append('slider_image', $('input[name=slider_image]').val());
            }
            data.append('images', $('input[name=images_1]').val());
            data.append('images', $('input[name=images_2]').val());
            data.append('images', $('input[name=images_3]').val());
            data.append('images', $('input[name=images_4]').val());
            if(__error){
                Alert.render(__message, function(){
                    btn.html('افزودن');
                    __a = true;
                    __error = false;
                    return;
                });
                __error = false;
                return;
            }
            jQuery.ajax(
                {
                    url: '',
                    type: "post",
                    data: data,
                    async: false,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        var status = response['status'];
                        var value = response['value'];
                        var messages = response['messages'];
                        if (status) {
                            Alert.render('success', function () {
                                location.href = "";
                                __a = true;
                            });
                        }else{
                            var error = '';
                            for(var i = 0; i < messages.length ; i++){
                                error += messages[i] + '<br>';
                            }
                            if(error == '')
                                error = 'error';
                            Alert.render(error, function(){
                                btn.html('افزودن');
                                __a = true;
                            });
                        }
                    },
                    error: function () {
                        Alert.render('error', function(){
                            btn.html('افزودن');
                            __a = true;
                        });
                    }
                });
        }
    });

    $(document).on('click', '.delete-image', function(e){
        var elm = $(e.target).closest('.delete-image');
        var btn_html = elm.html();
        elm.html(loader.replace(/15/g, "15"));
        if(!elm.hasClass('base-image')){
            var __a = elm.closest('.images-div').attr('data-image');
            $('.images-div[data-image=' + __a + ']').hide();
            $('.images-div[data-image=' + __a + '] img').attr('src', "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image");
            $('.images-div[data-image=' + __a + '] input.input-images').val("");
            if(__a == "1"){
                images_1 = false;
                $('#company_images_1_show img').attr({ src: "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" });
            }
            if(__a == "2"){
                images_2 = false;
                $('#company_images_2_show img').attr({ src: "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" });
            }
            if(__a == "3"){
                images_3 = false;
                $('#company_images_3_show img').attr({ src: "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" });
            }
            if(__a == "4"){
                images_4 = false;
                $('#company_images_4_show img').attr({ src: "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" });
            }
            elm.html(btn_html);
            return;
        }
        var postData = [
            {name: 'image', value: elm.attr('data-image')},
            {name: '_xsrf', value: '{{ handler.xsrf_token }}'}
        ];
        jQuery.ajax(
            {
                url: '',
                type: "delete",
                data: postData,
                success: function () {
                    var __a = elm.closest('.images-div').attr('data-image');
                    $('.images-div[data-image=' + __a + ']').hide();
                    $('.images-div[data-image=' + __a + '] img').attr('src', "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image");
                    $('.images-div[data-image=' + __a + '] input.input-images').val("");
                    if(__a == "1"){
                        images_1 = false;
                        $('#company_images_1_show img').attr({ src: "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" });
                    }
                    if(__a == "2"){
                        images_2 = false;
                        $('#company_images_2_show img').attr({ src: "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" });
                    }
                    if(__a == "3"){
                        images_3 = false;
                        $('#company_images_3_show img').attr({ src: "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" });
                    }
                    if(__a == "4"){
                        images_4 = false;
                        $('#company_images_4_show img').attr({ src: "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" });
                    }
                    elm.html(btn_html);
                }
            });
    });

    var images_1 = parseInt('{{ len(company['images']) }}') >= 1;
    var images_2 = parseInt('{{ len(company['images']) }}') >= 2;
    var images_3 = parseInt('{{ len(company['images']) }}') >= 3;
    var images_4 = parseInt('{{ len(company['images']) }}') >= 4;

    var count_images = 0;
    $(document).on('click', '.add-image', function(){
        if(!images_1 || !images_2 || !images_3 || !images_4) {
            if(!images_1){
                $('.images-div[data-image=1]').show();
                images_1 = true;
            }else if(!images_2){
                $('.images-div[data-image=2]').show();
                images_2 = true;
            }else  if(!images_3){
                $('.images-div[data-image=3]').show();
                images_3 = true;
            }else  if(!images_4){
                $('.images-div[data-image=4]').show();
                images_4 = true;
            }
        }
    });

    $('select[name=province]').on("change", function(){
        var province = $(this).val();
        var postData = [
            {name: 'province', value: province},
            {name: '_xsrf', value: '{{ handler.xsrf_token }}'}
        ];
        jQuery.ajax(
            {
                url: '{{ reverse_url('province_city') }}',
                type: "post",
                data: postData,
                success: function (response) {
                    $("select[name=city]").html(response['html']).val(response['selected']).trigger('change');
                }
            });
    });

    $('input.has-slider').on("change", function(){
        if($(this).prop("checked")){
            $(".slider-div").slideDown();
        }else{
            $('.slider-div').slideUp();
        }
    });

</script>
{% end block other_scripts %}